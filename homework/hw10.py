# feature engineering
import pickle
import numpy as np
import pandas as pd
from sklearn.feature_selection import mutual_info_regression
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor
from sklearn.metrics import mean_squared_error
import matplotlib.pyplot as plt
import seaborn as sns

# %%
# 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö Autos

with open('../datasets/mod_05_topic_10_various_data.pkl', 'rb') as fl:
    datasets = pickle.load(fl)

data = datasets['autos']
data.info()

# %%

# –î–æ–±–∞–≤–∏–º–æ –≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ —Ö–æ–¥—É –ø–æ—Ä—à–Ω—è stroke –¥–æ –¥—ñ–∞–º–µ—Ç—Ä–∞ —Ü–∏–ª—ñ–Ω–¥—Ä–∞ bor–µ (–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è S/D: Stroke/Diameter)
data['stroke_ratio'] = data['stroke'] / data['bore']
data[['stroke', 'bore', 'stroke_ratio']].head()


# %%
# –ø–µ–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤
data.isna().sum()
        # data.isna().mean().sort_values(ascending=False)  # –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫—ñ–≤ –∑–∞ –∫–æ–∂–Ω–æ—é –∫–æ–ª–æ–Ω–∫–æ—é.
        # data = data.dropna()

#%%
# –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º —Ç–∏–ø—ñ–≤ –∑–º—ñ–Ω–Ω–∏—Ö
data.info()

# %%
# –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
data.select_dtypes(include='object').nunique()

# %%
# –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –æ–∑–Ω–∞–∫–∏
data.select_dtypes(include='object').apply(lambda x: x.unique()[:5])

# %%
# –û–≥–ª—è–¥ —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤
melted = data.select_dtypes(include='number').melt()

g = sns.FacetGrid(melted,
                  col='variable',
                  col_wrap=4,
                  sharex=False,
                  sharey=False,
                  aspect=1.25)

g.map(sns.histplot, 'value')

g.set_titles(col_template='{col_name}')

g.tight_layout()

plt.show()

#%%

from scipy.stats import skew

# –û–±—á–∏—Å–ª–µ–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∞—Å–∏–º–µ—Ç—Ä—ñ—ó
data_num = data.select_dtypes(include='number')

for col in data_num.columns:
    skew_value = skew(data_num[col], nan_policy='omit')  # –æ–±—Ä–æ–±–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
    print(f"{col:<18}: {skew_value:>5.2f}")
    
# –ê—Å–∏–º–µ—Ç—Ä—ñ—è –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª —á–∏—Å–ª–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó —î —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º –≤—ñ–¥–Ω–æ—Å–Ω–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è.
# 0 = —Å–∏–º–µ—Ç—Ä—ñ—è, –¥–æ 0.5 –Ω–∏–∑—å–∫–∞ –∞—Å–∏–º–µ—Ç—Ä—ñ—è, –¥–æ 1 - –ø–æ–º—ñ—Ä–Ω–∞, –±—ñ–ª—å—à–µ 1 - –≤–∏—Å–æ–∫–∞.


# %%
# 2. –í–∏–∑–Ω–∞—á—Ç–µ –ø–µ—Ä–µ–ª—ñ–∫ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –æ–∑–Ω–∞–∫ (–≤ —à–∏—Ä–æ–∫–æ–º—É —Ä–æ–∑—É–º—ñ–Ω–Ω—ñ) –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–æ–∫–∞–∑–Ω–∏–∫–∞ –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

# –í–∏–∫–æ–Ω–∞—î–º–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ú–Ü –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö Autos. (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –º–µ—Ç–æ–¥ mutual_info_regression() –ø–∞–∫–µ—Ç–∞ sklearn, 
# –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –Ω—å–æ–º—É —Ü—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ (price) —î –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–æ—é —á–∏—Å–ª–æ–≤–æ—é –≤–µ–ª–∏—á–∏–Ω–æ—é.)
# –û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–µ—Ç–æ–¥—É —î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å —è–≤–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è "–¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö" –æ–∑–Ω–∞–∫ —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.
# "–¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ" —Ç—É—Ç –∑–Ω–∞—á–∏—Ç—å –±—ñ–ª—å—à —Ç–æ—á–Ω—ñ "–∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ"  –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ—Å—Ç—å –ø—ñ–∫—Å–µ–ª—ñ–≤ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ —î –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ—é (–∞–ª–µ –Ω–µ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–æ—é). 
# –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö Autos —á–∏—Å–ª–æ–≤—ñ –æ–∑–Ω–∞–∫–∏, —Ç–∞–∫—ñ —è–∫ num_of_doors —ñ num_of_cylinders, –¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ (–∞–≤—Ç–æ–º–æ–±—ñ–ª—å –Ω–µ –º–æ–∂–µ –º–∞—Ç–∏ 4.5 –¥–≤–µ—Ä—ñ).

# –©–æ–¥–æ —ñ–Ω—à–∏—Ö —è–≤–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –æ–∑–Ω–∞–∫, —Å–ø–æ—á–∞—Ç–∫—É –º–∏ —ó—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ —á–∏—Å–ª–æ–≤—ñ —à–ª—è—Ö–æ–º –Ω–∞–¥–∞–Ω–Ω—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º –¥–æ–≤—ñ–ª—å–Ω–∏—Ö 
# —á–∏—Å–ª–æ–≤–∏—Ö –º—ñ—Ç–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É factorize(), –∞ –ø–æ—Ç—ñ–º –∑–∞–∑–Ω–∞—á–∞—î–º–æ –≤ –ø–µ—Ä–µ–ª—ñ–∫—É –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ.

X = data.copy()
y = X.pop('price')

cat_features = X.select_dtypes('object').columns

for colname in cat_features:
    X[colname], _ = X[colname].factorize()

# %%

# –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ MI –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ –æ–±‚Äô—î–∫—Ç Series —ñ —Å–æ—Ä—Ç—É—î–º–æ:  
mi_scores = mutual_info_regression(X, y,
    discrete_features=X.columns.isin(
        cat_features.to_list() +
        ['num_of_doors',
         'num_of_cylinders']),
    random_state=42)

mi_scores = (pd.Series( 
    mi_scores,
    name='MI Scores',
    index=X.columns)
    .sort_values())

mi_scores.sample(5)


# %%

discrete_features=X.columns.isin(
    cat_features.to_list() +
    ['num_of_doors',
     'num_of_cylinders'])

# –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ MI –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ –æ–±‚Äô—î–∫—Ç Series —ñ —Å–æ—Ä—Ç—É—î–º–æ:  
mi_scores = mutual_info_regression(X, y,
    discrete_features=discrete_features,
    random_state=42)

mi_scores = (pd.Series( 
    mi_scores,
    name='MI Scores',
    index=X.columns)
    .sort_values())

mi_scores.sample(5)

# %%
# –¢–µ–ø–µ—Ä –≤—ñ–∑—É–∞–ª—ñ–∑—É—î–º–æ –æ—Ç—Ä–∏–º–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏: 
plt.figure(figsize=(6, 8))
plt.barh(np.arange(len(mi_scores)), mi_scores)
plt.yticks(np.arange(len(mi_scores)), mi_scores.index)
plt.title('Mutual Information Scores')

plt.show()

# %%
# –¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –≤ –Ω–∞—Å —î "—Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ä–∏—Å–Ω–æ—Å—Ç—ñ" –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫ –∑–∞ –º–µ—Ç—Ä–∏–∫–æ—é MI, –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –±—ñ–ª—å—à –¥–æ–∫–ª–∞–¥–Ω–æ.
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, curb_weight (—Å–ø–æ—Ä—è–¥–∂–µ–Ω–∞ –º–∞—Å–∞ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è) —î –ª—ñ–¥–µ—Ä–æ–º —Ü—å–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —á–µ—Ä–µ–∑ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ —Ü—ñ—î—é –æ–∑–Ω–∞–∫–æ—é 
# –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ (–≤—ñ–¥–Ω–æ—Å–Ω–æ) ‚Äú–±–∞–≥–∞—Ç–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó‚Äù –ø—Ä–æ —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É, —Ç–æ–º—É —â–æ –º—ñ–∂ —Ü–∏–º–∏ –¥–≤–æ–º–∞ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏ —ñ—Å–Ω—É—î –∑–Ω–∞—á–Ω–∞ –≤–∑–∞—î–º–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å.

# –°–∞–º–µ —Ç–∞–∫—É —á—ñ—Ç–∫—É –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å (—É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –Ω–µ–ª—ñ–Ω—ñ–π–Ω—É) –º–∏ –π –±–∞—á–∏–º–æ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É —Ü–∏—Ö –¥–≤–æ—Ö –∑–º—ñ–Ω–Ω–∏—Ö:

sns.regplot(data=data, x='curb_weight', y='price', order=2)

plt.show()

# %%

# –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –æ–∑–Ω–∞–∫–∞ fuel_type –º–∞—î –¥–æ—Å–∏—Ç—å –Ω–∏–∑—å–∫–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ MI, –ø—Ä–æ—Ç–µ, –∑–≥—ñ–¥–Ω–æ –∑ –Ω–∞–≤–µ–¥–µ–Ω–∏–º –Ω–∏–∂—á–µ —Ä–∏—Å—É–Ω–∫–æ–º, 
# –≤–æ–Ω–∞ —á—ñ—Ç–∫–æ —Ä–æ–∑–¥—ñ–ª—è—î –¥–≤—ñ –≥—Ä—É–ø–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ü—ñ–Ω–æ–≤–∏–º–∏ —Ç—Ä–µ–Ω–¥–∞–º–∏ –∑–∞ –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º horsepower.

# –Ø–∫ –≤—ñ–¥–æ–º–æ, –¥–∏–∑–µ–ª—å–Ω–µ –ø–∞–ª–∏–≤–æ –º–∞—î –±—ñ–ª—å—à—É —â—ñ–ª—å–Ω—ñ—Å—Ç—å –∑–∞ –±–µ–Ω–∑–∏–Ω (–≤ –∫–æ–∂–Ω–æ–º—É –ª—ñ—Ç—Ä—ñ –±—ñ–ª—å—à–µ –µ–Ω–µ—Ä–≥—ñ—ó). –¢–æ–º—É –∑–∞ –æ–¥–Ω–∞–∫–æ–≤–æ—ó –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ 
# –¥–∏–∑–µ–ª—å–Ω—ñ –¥–≤–∏–≥—É–Ω–∏ –±—ñ–ª—å—à –≤–∏–≥—ñ–¥–Ω—ñ. –¶–∏–º –º–æ–∂–Ω–∞ –ø–æ—è—Å–Ω–∏—Ç–∏ –¥–∏–Ω–∞–º—ñ–∫—É —Ü—ñ–Ω - –¥–∏–∑–µ–ª—å–Ω—ñ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ –º–∞—é—Ç—å —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—é –∫–æ—à—Ç—É–≤–∞—Ç–∏ –¥–æ—Ä–æ–∂—á–µ.

sns.lmplot(data=autos,
           x='horsepower',
           y='price',
           hue='fuel_type',
           facet_kws={'legend_out': False})

plt.show()

# –¶–µ —ñ–ª—é—Å—Ç—Ä—É—î, —â–æ –æ–∑–Ω–∞–∫–∞ –º–æ–∂–µ –∑–∞–ª–∏—à–∞—Ç–∏—Å—è –∫–æ—Ä–∏—Å–Ω–æ—é –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –Ω–∏–∑—å–∫–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ 
# –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—ñ–∑ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é). –ü–æ–±–∞—á–∏–º–æ –≤ —Ä–∞–º–∫–∞—Ö –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è. 
# –ß–∞—Å—Ç–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–Ω–∞–Ω—å —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ–π –ø—Ä–µ–¥–º–µ—Ç–Ω—ñ–π –≥–∞–ª—É–∑—ñ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∏—è–≤–∏—Ç–∏ —Ç–∞–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏.



#%% 
# 3. –†–æ–∑—Ä–∞—Ö—É–π—Ç–µ –ø–æ–∫–∞–∑–Ω–∏–∫ –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–ª—è –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫ —ñ —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó price –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É mutual_info_regression() –∑ –ø–∞–∫–µ—Ç–∞ sklearn.
target = autos.pop("price")

mis = mutual_info_regression(autos.reshape(-1, 1), target)[0]
# cor = np.corrcoef(x, y)[0, 1]

print(f'MI score: {mis:.2f} | Cor index: {cor:.2f}')

# %%
# 4. –ü–æ–±—É–¥—É–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—É –º–æ–¥–µ–ª—å / –∞–Ω—Å–∞–º–±–ª—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–±—î–∫—Ç–∞ RandomForestRegressor–∞–±–æGradientBoostingRegressor–∑ –ø–∞–∫–µ—Ç–∞sklearn`) –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫, –ø–æ–¥—ñ–±–Ω–æ –¥–æ —Ç–æ–≥–æ, —è–∫ –º–∏ —Ü–µ —Ä–æ–±–∏–ª–∏ —É —Ç–µ–º—ñ ¬´–î–µ—Ä–µ–≤–∞ —Ä—ñ—à–µ–Ω—å. –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ –≤ –º–æ–¥–µ–ª—ñ¬ª –≤ —Ä–æ–∑–¥—ñ–ª—ñ ¬´–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ —É –º–æ–¥–µ–ª—ñ¬ª.
    # –î–ª—è –ø–æ–±—É–¥–æ–≤–∏ –º–æ–¥–µ–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö / –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –æ–∑–Ω–∞–∫ –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.
    
# –†–æ–∑–¥—ñ–ª—è—î–º–æ –¥–∞–Ω—ñ –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—É —Ç–∞ —Ç–µ—Å—Ç–æ–≤—É –≤–∏–±—ñ—Ä–∫–∏
# X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)


#%%
# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ RandomForestRegressor
rfr_model = RandomForestRegressor(random_state=42)
rfr_model.fit(X, y)

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ –∑ GradientBoostingRegressor
rfr_feature_importances = pd.Series(
    rfr_model.feature_importances_,
    name='RFR Feature Importances',
    index=X.columns
).sort_values()

# –í–∏–±—ñ—Ä–∫–∞ 5 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
rfr_feature_importances.sample(5)

#%% 
import numpy as np
import matplotlib.pyplot as plt

# –î–æ–≤–∂–∏–Ω–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
indices = np.arange(len(mi_scores))

# –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
plt.figure(figsize=(8, 8))

# –í–∑–∞—î–º–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è (mi_scores)
plt.barh(indices + 0.2, mi_scores, height=0.4, label='Mutual Information Scores')

# –í–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ –∑ Random Forest (rfr_feature_importances)
plt.barh(indices - 0.2, rfr_feature_importances, height=0.4, color='red', label='RF Feature Importances')

# –ü—ñ–¥–ø–∏—Å –æ—Å–µ–π
plt.yticks(indices, mi_scores.index)
plt.title('Comparison of Mutual Information Scores and RF Feature Importances')

# –õ–µ–≥–µ–Ω–¥–∞
plt.legend()

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—É
plt.show()

#%%
# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ GradientBoostingRegressor
gbr_model = GradientBoostingRegressor(random_state=42)
gbr_model.fit(X, y)

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ –∑ GradientBoostingRegressor
gbr_feature_importances = pd.Series(
    gbr_model.feature_importances_,
    name='GBR Feature Importances',
    index=X.columns
).sort_values()

# –í–∏–±—ñ—Ä–∫–∞ 5 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó
gbr_feature_importances.sample(5)

#%% 





# # –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ –¥–ª—è RandomForest
# rf_feature_importances = rf_model.feature_importances_

# # –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ –¥–ª—è GradientBoosting
# gb_feature_importances = gb_model.feature_importances_



# # –í–∏–≤–µ–¥–µ–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫
# print("–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ (RandomForest):")
# for feature, importance in zip(X.columns, rf_feature_importances):
#     print(f"{feature}: {importance:.4f}")

# print("\n–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ (GradientBoosting):")
# for feature, importance in zip(X.columns, gb_feature_importances):
#     print(f"{feature}: {importance:.4f}")
    
    
#%% 
import numpy as np
import matplotlib.pyplot as plt

# –î–æ–≤–∂–∏–Ω–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
indices = np.arange(len(mi_scores))

# –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
plt.figure(figsize=(8, 8))

# –í–∑–∞—î–º–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è (mi_scores)
plt.barh(indices + 0.2, mi_scores, height=0.4, label='Mutual Information Scores')

# –í–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ –∑ Random Forest (gbr_feature_importances)
plt.barh(indices - 0.2, gbr_feature_importances, height=0.4, color='brown', label='Gradient Boosting Feature Importances')

# –ü—ñ–¥–ø–∏—Å –æ—Å–µ–π
plt.yticks(indices, mi_scores.index)
plt.title('Comparison of Mutual Information Scores and Gradient Boosting Feature Importances')

# –õ–µ–≥–µ–Ω–¥–∞
plt.legend()

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—É
plt.show()


# %%
# 5. –ú–∞—Å—à—Ç–∞–±—É–π—Ç–µ / —É–Ω—ñ—Ñ—ñ–∫—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ –∑–∞ —Å–≤–æ—î—é –ø—Ä–∏—Ä–æ–¥–æ—é –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ —É –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É .rank(pct=True) –æ–±‚Äô—î–∫—Ç–∞ DataFrame –∑ –ø–∞–∫–µ—Ç–∞ pandas.


# –î–µ—Ç–∞–ª—ñ —â–æ–¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ç–æ–¥—É –¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó.

# %%
# 6. –ü–æ–±—É–¥—É–π—Ç–µ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é —Ç–∏–ø—É grouped barsplots –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ–±–æ—Ö –Ω–∞–±–æ—Ä—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É catplot() –∑ –ø–∞–∫–µ—Ç–∞ seaborn.

# üí° –î–ª—è —Ü—å–æ–≥–æ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º —á–∏–Ω–æ–º –ø–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É .melt() –∑ –ø–∞–∫–µ—Ç–∞ pandas.

# %%
#7. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π—Ç–µ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é —Ç–∞ –∑—Ä–æ–±—ñ—Ç—å –≤–∏—Å–Ω–æ–≤–∫–∏.




# %%

# –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∫–ª—é—á–∞—é—Ç—å —É —Å–µ–±–µ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é (–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è) –æ–∑–Ω–∞–∫ —Ç–∞ —ó—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—Ç–µ–ø–µ–Ω—ñ–≤ –∞–±–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—ñ–≤. 
# –¶—ñ –ø—Ä–∏–π–æ–º–∏ –º–∏ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –∫–æ—Ä–µ–∫—Ü—ñ—ó –∞—Å–∏–º–µ—Ç—Ä—ñ—ó —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ–∑–Ω–∞–∫ —É —Ç–µ–º—ñ ‚Äú–ë–∞—î—Å—ñ–≤—Å—å–∫–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è. –ú–µ—Ç–æ–¥ kNN‚Äù.) 

# –¢—É—Ç —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ —Ä–æ–∑–ø–æ–¥—ñ–ª —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≤—ñ—Ç—Ä—É –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó –≤ –°–®–ê (–¥–∞—Ç–∞—Å–µ—Ç Accidents), —è–∫–∏–π —î –¥—É–∂–µ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º. 
# –ü—Ä–æ—Å—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ –¥–æ–ø–æ–º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª —Ü—ñ—î—ó –æ–∑–Ω–∞–∫–∏, –∑—Ä–æ–±–∏–≤—à–∏ —ó—ó –Ω–∞–±–∞–≥–∞—Ç–æ ‚Äú—ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ñ—à–æ—é‚Äù –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è:

accidents = datasets['accidents']

accidents['LogWindSpeed'] = accidents['WindSpeed'].apply(np.log1p)

sns.set_theme()

fig, axs = plt.subplots(1, 2, figsize=(8, 4))
sns.kdeplot(accidents.WindSpeed, fill=True, ax=axs[0])
sns.kdeplot(accidents.LogWindSpeed, fill=True, ax=axs[1])

plt.show()

# %%
# –ü—Ä–∏–π–æ–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –æ–∑–Ω–∞–∫. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
# –£ –Ω–∞–±–æ—Ä–∞—Ö –º–æ–∂–µ –±—É—Ç–∏ –Ω–∏–∑–∫–∞ –æ–¥–Ω–æ—Ç–∏–ø–Ω–∏—Ö –æ–∑–Ω–∞–∫, —è–∫—ñ –≤–∫–∞–∑—É–≤–∞—Ç–∏–º—É—Ç—å –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤ –æ–±‚Äô—î–∫—Ç–∞ –ø–µ–≤–Ω–∏—Ö 
# (–ø–æ—î–¥–Ω—É–≤–∞–Ω–∏—Ö –∞–±–æ –≤–∑–∞—î–º–æ–≤–∏–∫–ª—é—á–Ω–∏—Ö) —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫.

# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–∞–±–æ—Ä—ñ, –¥–µ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è –æ–ø–∏—Å—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —É –ø–∞—Ü—ñ—î–Ω—Ç–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∏—Ö —Å–∏–º–ø—Ç–æ–º—ñ–≤. 
# –î–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –º–æ–¥–µ–ª—ñ –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –∑–º—ñ–Ω–Ω—É, —è–∫–∞ —Ä–∞—Ö—É–≤–∞—Ç–∏–º–µ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–∑–Ω–∞–∫, –Ω–∞—è–≤–Ω–∏—Ö –≤ –æ–±'—î–∫—Ç–∞, –∑ –ø–µ–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–ª—ñ–∫—É.
# –¢–∞–∫—ñ –æ–∑–Ω–∞–∫–∏ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å –±—ñ–Ω–∞—Ä–Ω–∏–π (1/0) –∞–±–æ –±—É–ª–µ–≤–∏–π (True/False) —Ç–∏–ø. –£ Python –º–æ–∂–Ω–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏ –±—É–ª–µ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞–∫ —Å–∞–º–æ, —è–∫ —ñ —Ü—ñ–ª—ñ —á–∏—Å–ª–∞. 
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö Accidents –º—ñ—Å—Ç–∏—Ç—å –æ–∑–Ω–∞–∫–∏, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å, —á–∏ –±—É–≤ –Ω–∞ –¥–æ—Ä–æ–∑—ñ –ø–æ—Ä—É—á —ñ–∑ –º—ñ—Å—Ü–µ–º –∞–≤–∞—Ä—ñ—ó –ø–µ–≤–Ω–∏–π –¥–æ—Ä–æ–∂–Ω—ñ–π –∑–Ω–∞–∫. 
# –©–æ–± –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–Ω–∞–∫—ñ–≤ –ø–æ–±–ª–∏–∑—É –º—ñ—Å—Ü—è –∞–≤–∞—Ä—ñ—ó, –º–æ–∂–Ω–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –º–µ—Ç–æ–¥–æ–º sum():

roadway_features = ['Amenity',
                    'Bump',
                    'Crossing',
                    'GiveWay',
                    'Junction',
                    'NoExit',
                    'Railway',
                    'Roundabout',
                    'Station',
                    'Stop',
                    'TrafficCalming',
                    'TrafficSignal']

accidents['RoadwayFeatures'] = accidents[roadway_features].sum(axis=1)

accidents[roadway_features + ['RoadwayFeatures']].head(10)

# %%
# –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ç–æ–¥–∏ Pandas –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±—É–ª–µ–≤–∏—Ö –æ–∑–Ω–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∏—Å–ª–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å.
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –ø—Ä–æ –±–µ—Ç–æ–Ω (–¥–∞—Ç–∞—Å–µ—Ç Concrete) –º—ñ—Å—Ç–∏—Ç—å –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –ø—Ä–æ –≤–º—ñ—Å—Ç –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —É —Ä—ñ–∑–Ω–∏—Ö —Ä–µ—Ü–µ–ø—Ç—É—Ä–Ω–∏—Ö —Ñ–æ—Ä–º—É–ª–∞—Ö –±–µ—Ç–æ–Ω—É. 
# –°–µ—Ä–µ–¥ —ñ–Ω—à–æ–≥–æ, —Ñ–æ—Ä–º—É–ª–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—é –æ–¥–Ω–æ–≥–æ —á–∏ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ (—Ç–æ–±—Ç–æ —ó—Ö –≤–º—ñ—Å—Ç –¥–æ—Ä—ñ–≤–Ω—é—î 0).
# –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤—à–∏ —á–∏—Å–ª–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ –Ω–∞ –±—É–ª–µ–≤—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É gt() ("greater than‚Äù), 
# –º–æ–∂–Ω–∞ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —É —Ñ–æ—Ä–º—É–ª—ñ.

concrete = datasets['concrete']

components = ['Cement',
              'BlastFurnaceSlag',
              'FlyAsh',
              'Water',
              'Superplasticizer',
              'CoarseAggregate',
              'FineAggregate']

concrete['Components'] = concrete[components].gt(0).sum(axis=1)

concrete[components + ['Components']].head(10)

# –û–∑–Ω–∞–∫–∏, —Å—Ç–≤–æ—Ä–µ–Ω—ñ —à–ª—è—Ö–æ–º –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∫—ñ–ª—å–∫–æ—Å—Ç—ñ, –º–æ–∂—É—Ç—å —Å—Ç–∞—Ç–∏ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π/–∞–Ω—Å–∞–º–±–ª—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ ‚Äú–¥–µ—Ä–µ–≤ —Ä—ñ—à–µ–Ω—å‚Äù, 
# –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ –º–∞—î ‚Äú–≤–±—É–¥–æ–≤–∞–Ω–æ–≥–æ‚Äù –º–µ—Ö–∞–Ω—ñ–∑–º—É –¥–ª—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ–≥–æ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑–∞ –∫—ñ–ª—å–∫–æ–º–∞ –æ–∑–Ω–∞–∫–∞–º–∏.

# %%
# –ß–∞—Å—Ç–æ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Ü—ñ–ª—å–Ω–∏–º —Ä–æ–∑–±–∏—Ç–∏ –æ–∑–Ω–∞–∫–∏ –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏ –Ω–∞ –æ–∫—Ä–µ–º—ñ —á–∞—Å—Ç–∏–Ω–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∫–æ—Ä–∏—Å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.
#  –û—Å—å –∫—ñ–ª—å–∫–∞ —Ç–∏–ø–æ–≤–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –æ–∑–Ω–∞–∫:
    # - –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω—ñ –Ω–æ–º–µ—Ä–∏: '123-45-6789'.
    # - –ù–æ–º–µ—Ä–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤: '(–•–•–•) 987-65-43'.
    # - –ü–æ—à—Ç–æ–≤—ñ –∞–¥—Ä–µ—Å–∏: '1234 Unknown St, Unnamed City, NV'.
    # –®—Ç—Ä–∏—Ö-–∫–æ–¥–∏ —Ç–æ–≤–∞—Ä—ñ–≤: '0 36000 29145 2'.
    # –î–∞—Ç–∞ —ñ —á–∞—Å: 'Mon Sep 30 07:06:05 2013'.
# –ó–∞–∑–≤–∏—á–∞–π —Ç–∞–∫—ñ –¥–∞–Ω—ñ –º–∞—é—Ç—å –ø–µ–≤–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Ä–æ–∑—É–º—ñ–Ω–Ω—è —è–∫–æ—ó –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –æ–∑–Ω–∞–∫. 
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–æ–º–µ—Ä–∞—Ö —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤ –ø–µ—Ä—à—ñ —Ü–∏—Ñ—Ä–∏ (XXX) - –∫–æ–¥ –º—ñ—Å—Ç–∞, —â–æ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∞–±–æ–Ω–µ–Ω—Ç–∞. 
# split() (–¥–æ—Å—Ç—É–ø–Ω–∏–π —É Pandas —á–µ—Ä–µ–∑ –∞–∫—Å–µ—Å–æ—Ä .str) —Ç–µ–∫—Å—Ç –ª–µ–≥–∫–æ —Ä–æ–∑–±–∏–≤–∞—Ç–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö. 
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç—ñ–≤ (–¥–∞—Ç–∞—Å–µ—Ç –°ustomer), –º–æ–∂–Ω–∞ —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –æ–∑–Ω–∞–∫—É Policy (—Å—Ç—Ä–∞—Ö–æ–≤–∏–π –ø–æ–ª—ñ—Å) –Ω–∞ —Ç–∏–ø–∏ –π —Ä—ñ–≤–Ω—ñ –ø–æ–∫—Ä–∏—Ç—Ç—è:

customer = datasets['customer']

customer[['Type', 'Level']] = (
    customer['Policy']
    .str
    .split(' ', expand=True))

customer[['Policy', 'Type', 'Level']].head(10)

# %%
# –ü–æ–¥—ñ–±–Ω–∏–π –ø—Ä–∏–π–æ–º –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–ª—è —Ä–æ–∑–±–∏—Ç—Ç—è –æ–∑–Ω–∞–∫–∏ Date –Ω–∞ –æ–∫—Ä–µ–º—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∫—É –π –º—ñ—Å—è—Ü—è –≤ —Ç–µ–º—ñ ‚Äú–õ–æ–≥—ñ—Å—Ç–∏—á–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è‚Äù.
# –¢–∞–∫ —Å–∞–º–æ –º–æ–∂–µ–º–æ –æ–±'—î–¥–Ω–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ –æ–∑–Ω–∞–∫–∏ –≤ –Ω–æ–≤—É –∫–æ–º–±—ñ–Ω–æ–≤–∞–Ω—É –æ–∑–Ω–∞–∫—É, —è–∫—â–æ –≤–≤–∞–∂–∞—î–º–æ, —â–æ —Ü–µ –∫—Ä–∞—â–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏–º–µ –Ω–µ—è–≤–Ω—ñ –∑–≤‚Äô—è–∑–∫–∏ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.
# –ü–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –¥–∞—Ç–∞—Å–µ—Ç—É Autos —ñ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä—É—î–º–æ —Ü–µ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –æ–∑–Ω–∞–∫ make —ñ body_style:

autos['make_and_style'] = autos['make'] + '_' + autos['body_style']
autos[['make', 'body_style', 'make_and_style']].head()

# –ú–æ–¥–µ–ª—ñ/–∞–Ω—Å–∞–º–±–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ ‚Äú–¥–µ—Ä–µ–≤ —Ä—ñ—à–µ–Ω—å‚Äù –º–æ–∂—É—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–∞–π–∂–µ –±—É–¥—å-—è–∫–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –æ–∑–Ω–∞–∫.
# –û–¥–Ω–∞–∫, —è–∫—â–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è –æ–∑–Ω–∞–∫ —î –æ—Å–æ–±–ª–∏–≤–æ –≤–∞–∂–ª–∏–≤–æ—é, —ó—ó —è–≤–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –π –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤ –º–æ–¥–µ–ª—å –º–æ–∂–µ –ø–æ–∫—Ä–∞—â–∏—Ç–∏
# —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, –æ—Å–æ–±–ª–∏–≤–æ –∑–∞ —É–º–æ–≤–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –Ω–∞ (–≤—ñ–¥–Ω–æ—Å–Ω–æ) –Ω–µ–≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–∏—Ö.

# %%
# –ì—Ä—É–ø–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å –Ω–∞–º –æ–±'—î–¥–Ω—É–≤–∞—Ç–∏ (–∞–≥—Ä–µ–≥—É–≤–∞—Ç–∏) —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–∞ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ –æ–±'—î–∫—Ç–∞–º–∏, —è–∫—ñ –Ω–∞–ª–µ–∂–∞—Ç—å –¥–æ –æ–¥–Ω—ñ—î—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó. 
# –¶–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–∫–∏—Ö –Ω–æ–≤–∏—Ö –ø–æ—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫, —è–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "—Å–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å –¥–æ—Ö–æ–¥—É –∑–∞ –º—ñ—Å—Ü–µ–º –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è".

# –Ø–∫—â–æ –º–∏ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ –º—ñ–∂ –æ–±'—î–∫—Ç–∞–º–∏ —Ä—ñ–∑–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —ñ—Å–Ω—É—é—Ç—å –ø–µ–≤–Ω—ñ –Ω–µ—è–≤–Ω—ñ –∑–≤'—è–∑–∫–∏, —Ç–æ –≥—Ä—É–ø–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–∂—É—Ç—å —Å—Ç–∞—Ç–∏ 
# –∑—Ä—É—á–Ω–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —è–∫ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Ç–∞–∫–∏—Ö –∑–≤'—è–∑–∫—ñ–≤, —Ç–∞–∫ —ñ –¥–ª—è —ó—Ö —è–≤–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –º–æ–¥–µ–ª—ñ.

# –º–µ—Ç–æ–¥ groupby() —ñ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –æ–∑–Ω–∞–∫–∏ AverageIncome –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –¥–∞—Ç–∞—Å–µ—Ç—É –°ustomer:

customer['AverageIncome'] = (customer
                             .groupby('State')['Income']
                             .transform('mean'))

ratio = customer["Income"] / customer["AverageIncome"]
ratio.hist()

customer[['State', 'Income', 'AverageIncome']].head(10)

# %%
# —Ä—É–ø–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –æ–∑–Ω–∞–∫, 
# –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥—Ä–∞—Ö—É–≤–∞–≤—à–∏ —á–∞—Å—Ç–æ—Ç–∏ —ó—Ö –∑—É—Å—Ç—Ä—ñ—á–∞–Ω–Ω—è –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.

customer = (customer
            .assign(StateFreq=lambda x:
                    x.groupby('State')['State']
                    .transform('count') /
                    x['State'].count()))

customer[['State', 'StateFreq']].head(10)

# %%

# –ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏—Ç–æ–∫—É –¥–∞–Ω–∏—Ö, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –≥—Ä—É–ø–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è/—Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö, 
# –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ —É —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ.

# –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó —Ü—å–æ–≥–æ –ø—Ä–∏–π–æ–º—É —Å–ø–æ—á–∞—Ç–∫—É —Ä–æ–∑–¥—ñ–ª–∏–º–æ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö Customer –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—É (c_train) —ñ —Ç–µ—Å—Ç–æ–≤—É (c_test) –≤–∏–±—ñ—Ä–∫–∏. 
# –ü–æ—Ç—ñ–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è —Ä–æ–∑—Ä–∞—Ö—É—î–º–æ –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ —Å–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–º—ñ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –≤—ñ–¥—à–∫–æ–¥—É–≤–∞–Ω–Ω—è (ClaimAmount) –∑–∞ —Ä—ñ–∑–Ω–∏–º–∏ 
# –≤–∏–¥–∞–º–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∏—Ö –¥–æ–≥–æ–≤–æ—Ä—ñ–≤ (Coverage). –î–∞–ª—ñ –æ–±'—î–¥–Ω–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≥—Ä—É–ø–æ–≤–æ–≥–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑ —Ç–µ—Å—Ç–æ–≤–æ—é –≤–∏–±—ñ—Ä–∫–æ—é –∑–∞ –ø–æ–ª–µ–º Coverage, 
# —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤—à–∏ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –≤–∞—Ä—ñ–∞–Ω—Ç –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ü—ñ—î—ó –æ–∑–Ω–∞–∫–∏ –∑–∞ —ñ–Ω—à–æ—é –∑–º—ñ–Ω–Ω–æ—é (ClaimAmount) —ñ–∑ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö.

c_train = customer.sample(frac=0.75)
c_test = customer.drop(c_train.index)

c_train['AverageClaim'] = (c_train
                           .groupby('Coverage')['ClaimAmount']
                           .transform('mean'))

c_test = c_test.merge(
    c_train[['Coverage', 'AverageClaim']].drop_duplicates(),
    on='Coverage',
    how='left')

c_test[['Coverage', 'AverageClaim']].head(10)

# –ó–∞–∑–Ω–∞—á–∏–º–æ, —â–æ –Ω–∞–≤–µ–¥–µ–Ω–∏–π –ø–µ—Ä–µ–ª—ñ–∫ –ø—Ä–∏–π–æ–º—ñ–≤ feature engineering –Ω–µ —î –≤–∏—á–µ—Ä–ø–Ω–∏–º. 
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Ç–µ–º—ñ "–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è" –º–∏ —Å—Ç–∏–∫–∞–ª–∏—Å—è –∑ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏, –∞–ª–µ –¥–∞–ª—ñ –Ω–µ –±—É–¥–µ–º–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏.

# –ö—Ä—ñ–º —Ç–æ–≥–æ, –ø–æ–∑–∞ –º–µ–∂–∞–º–∏ –∫—É—Ä—Å—É –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Ä–æ–∑–≥–ª—è–¥ –º–µ—Ç–æ–¥—ñ–≤ –≤–∏–ª—É—á–µ–Ω–Ω—è –æ–∑–Ω–∞–∫ (feature engineering) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ 
# —ñ–∑ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ —Ç–µ–∫—Å—Ç–æ–≤—ñ –∞–±–æ —Ñ–æ—Ç–æ–º–∞—Ç–µ—Ä—ñ–∞–ª–∏, —è–∫—ñ –∞—Å–æ—Ü—ñ—é—é—Ç—å—Å—è –∑ –æ–±‚Äô—î–∫—Ç–∞–º–∏ –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö. 
# –û—Ç—Ä–∏–º–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –≤–µ–∫—Ç–æ—Ä–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –æ–∑–Ω–∞–∫ –º–æ–∂–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏—Ö ML-–∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤.


# %%

x = np.linspace(0, 2, 50)
y = np.sin(2 * np.pi * 0.25 * x)

sns.regplot(x=x, y=y)

 # %%

mis = mutual_info_regression(x.reshape(-1, 1), y)[0]
cor = np.corrcoef(x, y)[0, 1]

print(f'MI score: {mis:.2f} | Cor index: {cor:.2f}')

# %%
# –í—ñ–¥–±—ñ—Ä –æ–∑–Ω–∞–∫. –í–∑–∞—î–º–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏ –π —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é
# –ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö —ñ –π–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –æ–≥–ª—è–¥—É (–≤–∫–ª—é—á–Ω–æ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤, –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º —Ç–∏–ø—ñ–≤ –∑–º—ñ–Ω–Ω–∏—Ö, 
    # –æ–≥–ª—è–¥–æ–º —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤ —Ç–∞ –∞—Å–∏–º–µ—Ç—Ä—ñ—ó —á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö —Ç–æ—â–æ), 
    # –≤–∞—Ä—Ç–æ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ü—ñ–Ω–∏—Ç–∏ "–∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å" –æ–∑–Ω–∞–∫ —É –Ω–∞–±–æ—Ä—ñ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –Ω–∞ –ø—ñ–¥—Å—Ç–∞–≤—ñ —ó—Ö –∑–≤'—è–∑–∫—É –∑ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é. 
    # –í—ñ–¥–±—ñ—Ä –Ω–∞–π–±—ñ–ª—å—à —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏—Ö –æ–∑–Ω–∞–∫ –ø–æ–ª–µ–≥—à–∏—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö.

# –î–ª—è –æ—Ü—ñ–Ω–∫–∏ –∑–≤'—è–∑–∫—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –º–µ—Ç—Ä–∏–∫—É, –≤—ñ–¥–æ–º—É —è–∫ "–≤–∑–∞—î–º–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è" (MI ‚Äî mutual information). 
# –í–æ–Ω–∞ –ø–æ–¥—ñ–±–Ω–∞ –¥–æ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó, –ø—Ä–æ —è–∫—É –º–∏ –∑–≥–∞–¥—É–≤–∞–ª–∏ –≤ —Ç–µ–º—ñ ‚Äú–î–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö (EDA)‚Äù, –∞–ª–µ –º–∞—î –ø–µ—Ä–µ–≤–∞–≥—É –≤ —Ç–æ–º—É, 
# —â–æ –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ç–∏–ø –∑–≤'—è–∑–∫—É –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏, –∞ –Ω–µ –ª–∏—à–µ –ª—ñ–Ω—ñ–π–Ω–∏–π.
# –¶—è –º–µ—Ç—Ä–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞ —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –π —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó, –∞ —Ç–∞–∫–æ–∂ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –≤ –æ–±—á–∏—Å–ª–µ–Ω–Ω—ñ —ñ –º–∞—î —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è. 
# MI –≤–∏–º—ñ—Ä—é—î –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏ –≤ —Ç–µ—Ä–º—ñ–Ω–∞—Ö –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ, 
# —Ç–æ–±—Ç–æ –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –∑–Ω–∞–Ω–Ω—è –æ–¥–Ω—ñ—î—ó –≤–µ–ª–∏—á–∏–Ω–∏ –∑–º–µ–Ω—à—É—î –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å (–µ–Ω—Ç—Ä–æ–ø—ñ—é) —â–æ–¥–æ —ñ–Ω—à–æ—ó.

# –î–ª—è –ø—Ä–∏–∫–ª–∞–¥—É —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫ –º—ñ–∂ —è–∫—ñ—Å—Ç—é –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –æ–∑–¥–æ–±–ª–µ–Ω–Ω—è –±—É–¥–∏–Ω–∫—É –π —Ü—ñ–Ω–æ—é –Ω–∞ –Ω—å–æ–≥–æ, –≤–∑—è—Ç–∏–π —ñ–∑ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö Ames Housing. 
# –ö–æ–∂–Ω–∞ —Ç–æ—á–∫–∞ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø–µ–≤–Ω–∏–π –±—É–¥–∏–Ω–æ–∫. 
# –Ü–∑ –≥—Ä–∞—Ñ—ñ–∫–∞ —Å—Ç–∞—î –æ—á–µ–≤–∏–¥–Ω–∏–º, —â–æ –∫–æ–∂–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è ExterQual –∫–æ–Ω—Ü–µ–Ω—Ç—Ä—É—î —Ü—ñ–Ω—É –ø—Ä–æ–¥–∞–∂—É –≤ –ø–µ–≤–Ω–æ–º—É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ.
# –ó–Ω–∞—á–µ–Ω–Ω—è –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (MI), —è–∫–µ –æ—Ü—ñ–Ω—é—î –∑–≤'—è–∑–æ–∫ –º—ñ–∂ ExterQual —ñ SalePrice, –º–æ–∂–Ω–∞ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —è–∫ —Å–µ—Ä–µ–¥–Ω—å–æ–∑–≤–∞–∂–µ–Ω–µ –∑–º–µ–Ω—à–µ–Ω–Ω—è 
# –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ –≤ SalePrice, –ø–æ–≤‚Äô—è–∑–∞–Ω–µ –∑ –∫–æ–∂–Ω–æ—é –∑ —á–æ—Ç–∏—Ä—å–æ—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π ExterQual. 
# –ó–∞–≥–∞–ª–æ–º —Ü–µ –Ω–∞–≥–∞–¥—É—î –ø—ñ–¥—Ö—ñ–¥ –¥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ —É –º–æ–¥–µ–ª—ñ, —è–∫–∏–π –º–∏ —Ä–æ–∑–≥–ª—è–¥–∞–ª–∏ –≤ —Ç–µ–º—ñ ‚Äú–î–µ—Ä–µ–≤–∞ —Ä—ñ—à–µ–Ω—å.–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ–∑–Ω–∞–∫ —É –º–æ–¥–µ–ª—ñ‚Äù.

# –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ MI: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è = 0 —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –º—ñ–∂ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏. 
# –•–æ—á–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ –≤–µ—Ä—Ö–Ω—è –º–µ–∂–∞ MI –Ω–µ –æ–±–º–µ–∂–µ–Ω–∞, –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –≤–∏—â—ñ –∑–∞ 2, –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è —Ä—ñ–¥–∫–æ.

# –ö—Ä—ñ–º —Ç–æ–≥–æ, MI –æ—Ü—ñ–Ω—é—î –∑–≤'—è–∑–æ–∫ –æ–∑–Ω–∞–∫–∏ –∑ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é –æ–∫—Ä–µ–º–æ –≤—ñ–¥ —ñ–Ω—à–∏—Ö –æ–∑–Ω–∞–∫, —Ç–æ–¥—ñ —è–∫ –¥–µ—è–∫—ñ –æ–∑–Ω–∞–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –±—ñ–ª—å—à
# —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–º–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, –∫–æ–ª–∏ –≤–æ–Ω–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –æ–¥–Ω–∞ –∑ –æ–¥–Ω–æ—é. –¢–æ–º—É –≤–∞–∂–ª–∏–≤–æ —É—Å–≤—ñ–¥–æ–º–∏—Ç–∏, —â–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–∞ "–∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å" –æ–∑–Ω–∞–∫–∏ 
# –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ —Å–∏–≥–Ω–∞–ª–∏ –≤—ñ–¥ –Ω–µ—ó. 
# –ü–æ—Å–∏–ª–∏—Ç–∏ —Ç–∞–∫—ñ —Å–∏–≥–Ω–∞–ª–∏ –º–æ–∂–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏—Ö –≤–∏—â–µ –ø—Ä–∏–π–æ–º—ñ–≤ feature engineering.

# %%

# –í–∏–∫–æ–Ω–∞—î–º–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ú–Ü –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö Autos. (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –º–µ—Ç–æ–¥ mutual_info_regression() –ø–∞–∫–µ—Ç–∞ sklearn, 
# –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –Ω—å–æ–º—É —Ü—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ (price) —î –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–æ—é —á–∏—Å–ª–æ–≤–æ—é –≤–µ–ª–∏—á–∏–Ω–æ—é.)
# –û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–µ—Ç–æ–¥—É —î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å —è–≤–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è "–¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö" –æ–∑–Ω–∞–∫ —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.
# "–¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ" —Ç—É—Ç –∑–Ω–∞—á–∏—Ç—å –±—ñ–ª—å—à —Ç–æ—á–Ω—ñ "–∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ"  –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ—Å—Ç—å –ø—ñ–∫—Å–µ–ª—ñ–≤ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ —î –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ—é (–∞–ª–µ –Ω–µ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–æ—é). 
# –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö Autos —á–∏—Å–ª–æ–≤—ñ –æ–∑–Ω–∞–∫–∏, —Ç–∞–∫—ñ —è–∫ num_of_doors —ñ num_of_cylinders, –¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ (–∞–≤—Ç–æ–º–æ–±—ñ–ª—å –Ω–µ –º–æ–∂–µ –º–∞—Ç–∏ 4.5 –¥–≤–µ—Ä—ñ).

# –©–æ–¥–æ —ñ–Ω—à–∏—Ö —è–≤–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –æ–∑–Ω–∞–∫, —Å–ø–æ—á–∞—Ç–∫—É –º–∏ —ó—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ —á–∏—Å–ª–æ–≤—ñ —à–ª—è—Ö–æ–º –Ω–∞–¥–∞–Ω–Ω—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º –¥–æ–≤—ñ–ª—å–Ω–∏—Ö 
# —á–∏—Å–ª–æ–≤–∏—Ö –º—ñ—Ç–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É factorize(), –∞ –ø–æ—Ç—ñ–º –∑–∞–∑–Ω–∞—á–∞—î–º–æ –≤ –ø–µ—Ä–µ–ª—ñ–∫—É –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ.

X = autos.copy()
y = X.pop('price')

cat_features = X.select_dtypes('object').columns

for colname in cat_features:
    X[colname], _ = X[colname].factorize()

# %%
# –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ MI –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –Ω–∞ –æ–±‚Äô—î–∫—Ç Series —ñ —Å–æ—Ä—Ç—É—î–º–æ:

    mi_scores = mutual_info_regression(
    X, y,
    discrete_features=X.columns.isin(
        cat_features.to_list() +
        ['num_of_doors',
         'num_of_cylinders']),
    random_state=42)

mi_scores = (pd.Series(
    mi_scores,
    name='MI Scores',
    index=X.columns)
    .sort_values())

mi_scores.sample(5)

# %%
# –¢–µ–ø–µ—Ä –≤—ñ–∑—É–∞–ª—ñ–∑—É—î–º–æ –æ—Ç—Ä–∏–º–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏: 
plt.figure(figsize=(6, 8))
plt.barh(np.arange(len(mi_scores)), mi_scores)
plt.yticks(np.arange(len(mi_scores)), mi_scores.index)
plt.title('Mutual Information Scores')

plt.show()

# %%
# –¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –≤ –Ω–∞—Å —î "—Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ä–∏—Å–Ω–æ—Å—Ç—ñ" –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫ –∑–∞ –º–µ—Ç—Ä–∏–∫–æ—é MI, –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –±—ñ–ª—å—à –¥–æ–∫–ª–∞–¥–Ω–æ.
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥, curb_weight (—Å–ø–æ—Ä—è–¥–∂–µ–Ω–∞ –º–∞—Å–∞ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è) —î –ª—ñ–¥–µ—Ä–æ–º —Ü—å–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —á–µ—Ä–µ–∑ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ —Ü—ñ—î—é –æ–∑–Ω–∞–∫–æ—é 
# –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ (–≤—ñ–¥–Ω–æ—Å–Ω–æ) ‚Äú–±–∞–≥–∞—Ç–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó‚Äù –ø—Ä–æ —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É, —Ç–æ–º—É —â–æ –º—ñ–∂ —Ü–∏–º–∏ –¥–≤–æ–º–∞ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏ —ñ—Å–Ω—É—î –∑–Ω–∞—á–Ω–∞ –≤–∑–∞—î–º–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å.

# –°–∞–º–µ —Ç–∞–∫—É —á—ñ—Ç–∫—É –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å (—É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –Ω–µ–ª—ñ–Ω—ñ–π–Ω—É) –º–∏ –π –±–∞—á–∏–º–æ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É —Ü–∏—Ö –¥–≤–æ—Ö –∑–º—ñ–Ω–Ω–∏—Ö:

    sns.regplot(data=autos, x='curb_weight', y='price', order=2)

plt.show()

# %%

# –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –æ–∑–Ω–∞–∫–∞ fuel_type –º–∞—î –¥–æ—Å–∏—Ç—å –Ω–∏–∑—å–∫–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ MI, –ø—Ä–æ—Ç–µ, –∑–≥—ñ–¥–Ω–æ –∑ –Ω–∞–≤–µ–¥–µ–Ω–∏–º –Ω–∏–∂—á–µ —Ä–∏—Å—É–Ω–∫–æ–º, 
# –≤–æ–Ω–∞ —á—ñ—Ç–∫–æ —Ä–æ–∑–¥—ñ–ª—è—î –¥–≤—ñ –≥—Ä—É–ø–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ü—ñ–Ω–æ–≤–∏–º–∏ —Ç—Ä–µ–Ω–¥–∞–º–∏ –∑–∞ –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º horsepower.

# –Ø–∫ –≤—ñ–¥–æ–º–æ, –¥–∏–∑–µ–ª—å–Ω–µ –ø–∞–ª–∏–≤–æ –º–∞—î –±—ñ–ª—å—à—É —â—ñ–ª—å–Ω—ñ—Å—Ç—å –∑–∞ –±–µ–Ω–∑–∏–Ω (–≤ –∫–æ–∂–Ω–æ–º—É –ª—ñ—Ç—Ä—ñ –±—ñ–ª—å—à–µ –µ–Ω–µ—Ä–≥—ñ—ó). –¢–æ–º—É –∑–∞ –æ–¥–Ω–∞–∫–æ–≤–æ—ó –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ 
# –¥–∏–∑–µ–ª—å–Ω—ñ –¥–≤–∏–≥—É–Ω–∏ –±—ñ–ª—å—à –≤–∏–≥—ñ–¥–Ω—ñ. –¶–∏–º –º–æ–∂–Ω–∞ –ø–æ—è—Å–Ω–∏—Ç–∏ –¥–∏–Ω–∞–º—ñ–∫—É —Ü—ñ–Ω - –¥–∏–∑–µ–ª—å–Ω—ñ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ –º–∞—é—Ç—å —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—é –∫–æ—à—Ç—É–≤–∞—Ç–∏ –¥–æ—Ä–æ–∂—á–µ.

sns.lmplot(data=autos,
           x='horsepower',
           y='price',
           hue='fuel_type',
           facet_kws={'legend_out': False})

plt.show()

# –¶–µ —ñ–ª—é—Å—Ç—Ä—É—î, —â–æ –æ–∑–Ω–∞–∫–∞ –º–æ–∂–µ –∑–∞–ª–∏—à–∞—Ç–∏—Å—è –∫–æ—Ä–∏—Å–Ω–æ—é –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –Ω–∏–∑—å–∫–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ 
# –≤–∑–∞—î–º–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—ñ–∑ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é). –ü–æ–±–∞—á–∏–º–æ –≤ —Ä–∞–º–∫–∞—Ö –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è. 
# –ß–∞—Å—Ç–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–Ω–∞–Ω—å —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ–π –ø—Ä–µ–¥–º–µ—Ç–Ω—ñ–π –≥–∞–ª—É–∑—ñ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∏—è–≤–∏—Ç–∏ —Ç–∞–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏.